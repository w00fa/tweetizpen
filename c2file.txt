# Define the log file path
$logFile = "C:\Users\Public\Documents\log.txt"

# Function to log messages
function Log-Message {
    param (
        [string]$message
    )
    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"
    $logMessage = "$timestamp - $message"
    Add-Content -Path $logFile -Value $logMessage
}

# Log the start of the script
Log-Message "Script started."

# Function to send a test message to Discord webhook
function Send-TestMessageToDiscord {
    param (
        [string]$webhookUrl
    )
    
    Log-Message "Sending test message to Discord webhook."
    
    $body = @{
        content = "Test message from PowerShell script."
    }
    
    try {
        Invoke-RestMethod -Uri $webhookUrl -Method Post -ContentType "application/json" -Body ($body | ConvertTo-Json)
        Log-Message "Test message sent successfully."
    } catch {
        Log-Message "Failed to send test message. Error: $($_.Exception.Message)"
    }
}

# Send a test message to Discord webhook
$webhookUrl = "https://discord.com/api/webhooks/1243581518152990801/HeVZuyvWfQSYBl1ipXcbIEb2uIScSwlrXj6lazDoujaA741SdO4idCw8nhchRScTwinE"
Send-TestMessageToDiscord -webhookUrl $webhookUrl

# Log the end of the script
Log-Message "Script ended."
